# 设计取舍与实现原则

## 1. 目标与边界
- 完整对齐客户端协议与业务行为（登录、地图、战斗、宠物、道具、活动等）。  
- Go + Ent + Iris 作为统一后端技术基座，支持多数据库引擎。  
- GM 配置必须可追踪、可版本化、可即时生效。  

## 2. 核心原则
| 方向 | 原则 |
| --- | --- |
| 协议 | 先确保可跑通与稳定，再逐条补齐真实业务 |
| 结构 | 模块化拆分，避免全局可变状态扩散 |
| 数据 | 强一致与可追溯（事务、审计、版本） |
| 运维 | 低门槛部署与可观测性 |

## 3. 关键策略
- **双栈通信**：TCP 网关处理游戏协议，HTTP 提供资源与 GM API。  
- **数据建模**：所有业务数据进入 Ent 模型层，避免原生 SQL。  
- **配置治理**：配置写入数据库，支持回滚与审计。  
- **渐进还原**：按模块推进 CMD 补齐，逐步替换占位逻辑。  

## 4. 里程碑
| 阶段 | 目标 |
| --- | --- |
| Phase 1 | 登录/网关/资源/GM 可用，基础 CMD 可跑通 |
| Phase 2 | 宠物/任务/道具/好友等核心模块完善 |
| Phase 3 | 战斗、活动、经济系统完整还原 |
| Phase 4 | 运营级能力（配置推送、灰度、监控） |
